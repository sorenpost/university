<?xml version="1.0" encoding="utf-8"?>
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-02-21 Fri 14:27 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Algorithms</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Søren Post" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Algorithms</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org9f4b858">1. Revealed Comparative Advantage per capita</a></li>
<li><a href="#org1ee9c5a">2. <span class="done DONE">DONE</span> Fitness algorithm 2012</a>
<ul>
<li><a href="#orgf27c06a">2.1. Implementation</a>
<ul>
<li><a href="#org62a143a">2.1.1. F hat:</a></li>
<li><a href="#org8216882">2.1.2. Q hat:</a></li>
<li><a href="#orgfa88e7a">2.1.3. Normalization:</a></li>
</ul>
</li>
<li><a href="#orgf71faef">2.2. Coding</a></li>
</ul>
</li>
<li><a href="#org2af8e73">3. <span class="todo TODO">TODO</span> Fitness algorithm 2018</a></li>
<li><a href="#orga0d2f20">4. <span class="todo TODO">TODO</span> Method of Reflections</a></li>
<li><a href="#orgb27f3ee">5. To-do</a></li>
</ul>
</div>
</div>
<div id="outline-container-org9f4b858" class="outline-2">
<h2 id="org9f4b858"><span class="section-number-2">1</span> Revealed Comparative Advantage per capita</h2>
<div class="outline-text-2" id="text-1">
<p>
The per capita version of the RCA substitutes the reference distribution with population. That is, the RCA instead measures a countries export value per capita for a product divided by the global export value of the product per capita (ie. world population). There is a few benefits of this. First, it lessons the importance of price movements in a few products having large effects on the RCA of others (it is still not completely removed). Second, on a more practiacal note, it removes the divide-by-zero problem in the traditional equation.
</p>

<p>
Revealed Comparative Advantage per capita (\(RCA^{pc}\)) for country \(c\) in product \(p\) is defined as fined as:
</p>

<p>
\[ RCA_{cp}^{pc} = \frac{X_{cp}}{pop_c} / \frac{\sum_c X_{cp}}{\sum_c pop_c} \]
</p>

<p>
Method: divide intensity matrix by population vector. Divide total product vector by total population scalar. Divide the adjusted intensity matrix by the adjusted total vector.
</p>
</div>
</div>


<div id="outline-container-org1ee9c5a" class="outline-2">
<h2 id="org1ee9c5a"><span class="section-number-2">2</span> <span class="done DONE">DONE</span> Fitness algorithm 2012</h2>
<div class="outline-text-2" id="text-2">
<p>
The fitness algorithm is developed in <a class='org-ref-reference' href="#tacchella_new_2012-1">tacchella_new_2012-1</a>,<a class='org-ref-reference' href="#tacchella_economic_2013-2">tacchella_economic_2013-2</a>. The algorithm is an iterative process, where each iteration leverages the information from the previous to &ldquo;refine&rdquo; the information on which countries are the most fit and which products are the most complex. Basically, the most fit countries are those that export the most complex products, and the most complex products are those that are exported by the fittest countries. The main novelty of the fitness algorithm (compared to the Method of Reflections) is the insight that because many advanced countries export all kinds of products, but that less developed countries only export less complex products, there is more information in whether a less-fit country exports a product than if a more fit country does. Therefor, there is a non-linear penalty  to a product&rsquo;s complexity by having less fit countries export it (where the penalty is greater, the less fit the country is).
</p>

<p>
At each iteration \(n\) the algorithm is defined as:
</p>

\begin{cases}
\hat{F}_{c}^{(n)} = \sum_{p} M_{cp} Q_{p}^{(n - 1)} \\
\hat{Q}_{p}^{(n)} = \frac{1}{\sum_c M_{cp} \frac{1}{F_c^{(n - 1)}}}
\end{cases}

<p>
with normalization procedure
</p>

\begin{cases}
F_{c}^{(n)} = \frac{\hat{F}_{c}^{(n)}}{<\hat{F}_{c}^{(n)}>}_c \\
Q_{p}^{(n)} = \frac{\hat{Q}_{p}^{(n)}}{<\hat{Q}_{p}^{(n)}>}_p
\end{cases}

<p>
\(F_c^{n}\) is the fitness of country \(c\) in iteration \(n\) and \(Q^{(n)}_p\) is the complexity of product \(p\) and iteration \(n\). \(M\) is the country-product RCA matrix. It is usually defined as a binary matrix, but it does not have to be.
</p>

<p>
The starting conditions (at iteration 0) is defined as \(F^{0}_c = Q^{0}_c = 1 \forall c, p\). That is, the starting conditions for \(F_c\) and \(Q_p\) is just a vector of 1&rsquo;s that has the same length as the number of countries or products respectively.
</p>
</div>

<div id="outline-container-orgf27c06a" class="outline-3">
<h3 id="orgf27c06a"><span class="section-number-3">2.1</span> Implementation</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-org62a143a" class="outline-4">
<h4 id="org62a143a"><span class="section-number-4">2.1.1</span> F hat:</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
The equation for \(\hat{F}_c^{(n)}\) is simple. Each product RCA value in \(M\) should be weighted by their complexity values (\(Q_p\)). We then just take the sum of each countries complexity weighted RCA and get a vector of country values. This is \(\hat{F}^{(n)}_c\). Computationally, this is simple: we can simply just take a matrix-vector multiplication between \(M_{cp}\) and the previous iterations \(Q_p\).
</p>

<p>
\[\begin{bmatrix}
m_{11} & m_{12} & m_{13}  \\
m_{21} & m_{22} & m_{23}  \\
\end{bmatrix} \times
\begin{bmatrix}
q_{11} \\
q_{21} \\
q_{31}
\end{bmatrix} = \begin{bmatrix}
m_{11}q_{11} + m_{12}q_{21}  + m_{13}q_{31}   \\
m_{21}q_{11}  + m_{22}q_{21}  + m_{23}q_{31}   \\
\end{bmatrix}\]
</p>

<p>
Using real numbers, we get:
</p>

<p>
\[\begin{bmatrix}
11 & 12 & 13  \\
21 & 22 & 23  \\
\end{bmatrix} \times
\begin{bmatrix}
11 \\
21 \\
31
\end{bmatrix} = \begin{bmatrix}
11 \cdot 11 + 12 \cdot 21  + 13 \cdot 31   \\
21 \cdot 11  + 22 \cdot 21  + 23 \cdot 31   \\
\end{bmatrix} = \begin{bmatrix}
121 + 252 + 403 \\
231 + 462  + 713  \\
\end{bmatrix} = \begin{bmatrix}
776 \\
1406  \\
\end{bmatrix}\]
</p>

<p>
To see that this works in R, first I define M:
</p>

<div class="org-src-container">
<pre class="src src-R">
M <span style="color: #b751b6;">&lt;-</span> matrix(
  c(<span style="color: #da8548; font-weight: bold;">11</span>, <span style="color: #da8548; font-weight: bold;">12</span>, <span style="color: #da8548; font-weight: bold;">13</span>,
    <span style="color: #da8548; font-weight: bold;">21</span>, <span style="color: #da8548; font-weight: bold;">22</span>, <span style="color: #da8548; font-weight: bold;">23</span>),
  ncol = <span style="color: #da8548; font-weight: bold;">3</span>,
  nrow = <span style="color: #da8548; font-weight: bold;">2</span>,
  byrow = <span style="color: #986801;">TRUE</span>
)
</pre>
</div>

<p>
then Q:
</p>
<div class="org-src-container">
<pre class="src src-R">Q <span style="color: #b751b6;">&lt;-</span> c(<span style="color: #da8548; font-weight: bold;">11</span>, <span style="color: #da8548; font-weight: bold;">21</span>, <span style="color: #da8548; font-weight: bold;">31</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">11</td>
</tr>

<tr>
<td class="org-right">21</td>
</tr>

<tr>
<td class="org-right">31</td>
</tr>
</tbody>
</table>

<p>
And then the calculation:
</p>

<div class="org-src-container">
<pre class="src src-R">M <span style="color: #b751b6;">%*%</span> Q
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">776</td>
</tr>

<tr>
<td class="org-right">1406</td>
</tr>
</tbody>
</table>

<p>
Voila. I therefor implement the equation to \(\hat{F}^{n}_c\) as:
</p>

<div class="org-src-container">
<pre class="src src-R">F_hat <span style="color: #b751b6;">&lt;-</span> M <span style="color: #b751b6;">%*%</span> Q
</pre>
</div>
</div>
</div>

<div id="outline-container-org8216882" class="outline-4">
<h4 id="org8216882"><span class="section-number-4">2.1.2</span> Q hat:</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
We can use the same basic idea for \(\hat{Q}_{p}^{n}\). We first divide the scalar 1 by the \(F^{n - 1}_c\)  vector, then matrix-vector multiply \(M_{cp}\) with the resulting vector. Finally we just divide outcome vector by the scalar 1 one more time.
</p>

<p>
To see that it works:
</p>

<p>
\[ 1 / \begin{bmatrix}
f_{11} \\
f_{21}
\end{bmatrix} \rightarrow 1 / \begin{bmatrix}
11 \\
21
\end{bmatrix} = \begin{bmatrix}
1/11 \\
1/21
\end{bmatrix} = \begin{bmatrix}
0.09 \\
0.05
\end{bmatrix} \]
</p>

<p>
and in R:
</p>

<div class="org-src-container">
<pre class="src src-R">F <span style="color: #b751b6;">&lt;-</span> c(<span style="color: #da8548; font-weight: bold;">11</span>, <span style="color: #da8548; font-weight: bold;">21</span>)
round(<span style="color: #da8548; font-weight: bold;">1</span>/F, <span style="color: #da8548; font-weight: bold;">2</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0.09</td>
</tr>

<tr>
<td class="org-right">0.05</td>
</tr>
</tbody>
</table>

<p>
I now need to weight each product with the country-fitness values of the countries that export them (\(M_{cp} \frac{1}{F^{n - 1}_c}\)). That is, the vector \(\frac{1}{F^{n - 1}_c}\) needs to be multiplied column-wise into M. Essentially, I want the whole first row of M to be multiplied by the fitness of the country in the first row, the whole second row to be multiplied by the fitness of the second country, and so on. I then want to sum each column, so that the resulting vector becomes the same length as the number of products, where the first value is the sum of the fitness of all countries exporting the first product, and so forth.
</p>

<p>
This means that we must first transpose M so that dimensions fit:
</p>

<p>
\[
M^t \times (1 / F_c) = \begin{bmatrix} 11 & 21 \\
12 & 22 \\
13 & 23
\end{bmatrix} \times (1 / \begin{bmatrix}
11 \\
21
\end{bmatrix}) = \begin{bmatrix} 11 \cdot (1 / 11) + 21 \cdot (1 / 21) \\
12 \cdot (1 / 11) + 22 \cdot (1 / 21) \\
13 \cdot (1 / 11) + 23 \cdot (1 / 21)
\end{bmatrix} = \begin{bmatrix}  2  \\
2.14 \\
2.28 \end{bmatrix}
\]
</p>

<p>
Now each product is weighted by the country that exports it, and is summed column-wise in the original M (i.e. product wise).
</p>

<p>
In R:
</p>

<div class="org-src-container">
<pre class="src src-R">F <span style="color: #b751b6;">&lt;-</span> c(<span style="color: #da8548; font-weight: bold;">11</span>, <span style="color: #da8548; font-weight: bold;">21</span>) <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">two countries in M</span>
round(t(M) <span style="color: #b751b6;">%*%</span> (<span style="color: #da8548; font-weight: bold;">1</span>/F), <span style="color: #da8548; font-weight: bold;">2</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">2.14</td>
</tr>

<tr>
<td class="org-right">2.28</td>
</tr>
</tbody>
</table>

<p>
I therefor implement the equation to \(\hat{Q}^{n}_p\) as:
</p>

<div class="org-src-container">
<pre class="src src-R">Q_hat <span style="color: #b751b6;">&lt;-</span> <span style="color: #da8548; font-weight: bold;">1</span> / (t(M) <span style="color: #b751b6;">%*%</span> (<span style="color: #da8548; font-weight: bold;">1</span>/F))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfa88e7a" class="outline-4">
<h4 id="orgfa88e7a"><span class="section-number-4">2.1.3</span> Normalization:</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
The normalization procedure is simple enough. Each fitness value is divided by the average fitness value of the current iteration, and each complexity value is divided by the average complexity value of the current iteration.
</p>

<p>
For a sample \(\hat{F}\) of \([11, 21, 31]\), we simply take the average and divide it into the vector. For the \(\hat{F}\) from before, the average is \((11 + 21 + 31) / 3 = 21\). The new F is then:
\[ \begin{bmatrix} 11 / 21 & 21 / 21 & 31 / 21 \end{bmatrix} = \begin{bmatrix} 0.52 & 1 & 1.48 \end{bmatrix} \]
</p>

<p>
In R:
</p>

<div class="org-src-container">
<pre class="src src-R">F_hat <span style="color: #b751b6;">&lt;-</span> c(<span style="color: #da8548; font-weight: bold;">11</span>, <span style="color: #da8548; font-weight: bold;">21</span>, <span style="color: #da8548; font-weight: bold;">31</span>)

F <span style="color: #b751b6;">&lt;-</span> F_hat / mean(F_hat)

round(F, <span style="color: #da8548; font-weight: bold;">2</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">0.52</td>
</tr>

<tr>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">1.48</td>
</tr>
</tbody>
</table>

<p>
The normalisation procedures are therefor:
</p>

<div class="org-src-container">
<pre class="src src-R">Q <span style="color: #b751b6;">&lt;-</span> Q_hat / mean(Q_hat)
F <span style="color: #b751b6;">&lt;-</span> F_hat / mean(F_hat)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf71faef" class="outline-3">
<h3 id="orgf71faef"><span class="section-number-3">2.2</span> Coding</h3>
<div class="outline-text-3" id="text-2-2">
<p>
I now put the elements from above together in a function. N is the number of iterations, M is the RCA matrix. The M matrix should have product names as colnames and country names as rownames. I use two matrices to collect the results. The first matrix is an N times C matrix, where each column is a country and each row is an iteration number. The elements are the fitness of the country in the given iteration. The second matrix is the equivalent matrix for products.
</p>

<ul class="org-ul">
<li class="on"><code>[X]</code> Collection of all iteration results (for covergence graph)</li>
<li class="on"><code>[X]</code> Define return frame</li>
</ul>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #a626a4;">fitness2012</span> <span style="color: #b751b6;">&lt;-</span> <span style="color: #e45649;">function</span>(M, N) {

  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">NA values introduce all sorts of problems. These are not allowed in the M matrix</span>
  <span style="color: #e45649;">if</span>(sum(is.na(M) != <span style="color: #da8548; font-weight: bold;">0</span>) {
  <span style="color: #e45649;">stop</span>(<span style="color: #50a14f;">"M contains NA values. This makes things funky. Stopping."</span>)
  }

  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">define konstants</span>
  <span style="color: #9ca0a4;">## </span><span style="color: #9ca0a4;">number of countries</span>
  C <span style="color: #b751b6;">&lt;-</span> nrow(M)
  <span style="color: #9ca0a4;">## </span><span style="color: #9ca0a4;">number of products</span>
  P <span style="color: #b751b6;">&lt;-</span> ncol(M)

  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">define collection matrices</span>
  country_matrix <span style="color: #b751b6;">&lt;-</span> matrix(<span style="color: #986801;">NA</span>, ncol = C, nrow = N, dimnames = list(<span style="color: #da8548; font-weight: bold;">1</span>:N, rownames(M)))
  product_matrix <span style="color: #b751b6;">&lt;-</span> matrix(<span style="color: #986801;">NA</span>, ncol = P, nrow = N, dimnames = list(<span style="color: #da8548; font-weight: bold;">1</span>:N, colnames(M)))

  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">starting conditions</span>
  F <span style="color: #b751b6;">&lt;-</span> rep(<span style="color: #da8548; font-weight: bold;">1</span>, C)
  Q <span style="color: #b751b6;">&lt;-</span> rep(<span style="color: #da8548; font-weight: bold;">1</span>, P)

  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">Loop starts</span>
  <span style="color: #e45649;">for</span>(i <span style="color: #e45649;">in</span> <span style="color: #da8548; font-weight: bold;">0</span>:N) {

    F_hat <span style="color: #b751b6;">&lt;-</span> M <span style="color: #b751b6;">%*%</span> Q
    Q_hat <span style="color: #b751b6;">&lt;-</span> <span style="color: #da8548; font-weight: bold;">1</span> / (t(M) <span style="color: #b751b6;">%*%</span> (<span style="color: #da8548; font-weight: bold;">1</span>/F))

    <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">Normalize</span>
    F <span style="color: #b751b6;">&lt;-</span> F_hat / mean(F_hat)
    Q <span style="color: #b751b6;">&lt;-</span> Q_hat / mean(Q_hat)

    country_matrix[i, ] <span style="color: #b751b6;">&lt;-</span> F
    product_matrix[i, ] <span style="color: #b751b6;">&lt;-</span> Q
  }

  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">Make country_matrix into a long, tidy data frame</span>
  country_long <span style="color: #b751b6;">&lt;-</span> country_matrix <span style="color: #b751b6;">%&gt;%</span>
    as_tibble() <span style="color: #b751b6;">%&gt;%</span>
    rownames_to_column(var = <span style="color: #50a14f;">"iteration"</span>) <span style="color: #b751b6;">%&gt;%</span>
    gather(-iteration, key = <span style="color: #50a14f;">"name"</span>, value = <span style="color: #50a14f;">"value"</span>) <span style="color: #b751b6;">%&gt;%</span>
    mutate(entity = <span style="color: #50a14f;">"country"</span>,
           metric = <span style="color: #50a14f;">"fitness"</span>)

  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">Make product_matrix into a long, tidy data frame</span>
  product_long <span style="color: #b751b6;">&lt;-</span> product_matrix <span style="color: #b751b6;">%&gt;%</span>
    as_tibble() <span style="color: #b751b6;">%&gt;%</span>
    rownames_to_column(var = <span style="color: #50a14f;">"iteration"</span>) <span style="color: #b751b6;">%&gt;%</span>
    gather(-iteration, key = <span style="color: #50a14f;">"name"</span>, value = <span style="color: #50a14f;">"value"</span>) <span style="color: #b751b6;">%&gt;%</span>
    mutate(entity = <span style="color: #50a14f;">"product"</span>,
           metric = <span style="color: #50a14f;">"complexity"</span>)

  <span style="color: #9ca0a4;"># </span><span style="color: #9ca0a4;">Join the two long data frames and return them</span>
  return_tbl <span style="color: #b751b6;">&lt;-</span> rbind(country_long, product_long)

  <span style="color: #e45649;">return</span>(return_tbl)
}

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2af8e73" class="outline-2">
<h2 id="org2af8e73"><span class="section-number-2">3</span> <span class="todo TODO">TODO</span> Fitness algorithm 2018</h2>
<div class="outline-text-2" id="text-3">
<p>
The 2018 version of the fitness algorithm was developed to avoid certain
</p>
</div>
</div>

<div id="outline-container-orga0d2f20" class="outline-2">
<h2 id="orga0d2f20"><span class="section-number-2">4</span> <span class="todo TODO">TODO</span> Method of Reflections</h2>
<div class="outline-text-2" id="text-4">
<p>
The Method of Reflections was developed in <a class='org-ref-reference' href="#hidalgo_building_2009">hidalgo_building_2009</a>.
</p>

\begin{align}
k^{(n)}_c &= \frac{1}{k^{(0)}_c} \sum^{N_p}_{p = 1} M_{cp}k^{(n - 1)}_p \\
k^{(n)}_p &= \frac{1}{k^{(0)}_p} \sum^{N_c}_{c = 1} M_{cp}k^{(n - 1)}_c \\
k^{(0)}_c &= \sum^{N_p}_{p = 1} M_{cp} \\
k^{(0)}_p &= \sum^{N_c}_{c = 1} M_{cp}
\end{align}




<p>
<h1 class='org-ref-bib-h1'>Bibliography</h1>
<ul class='org-ref-bib'><li><a id="tacchella_new_2012-1">[tacchella_new_2012-1]</a> <a name="tacchella_new_2012-1"></a>Tacchella, Cristelli, Caldarelli, Gabrielli & Pietronero, A New Metrics for Countries' Fitness and Products' Complexity, <i>Scientific Reports</i>, <b>2(1)</b>, (2012). <a href="http://dx.doi.org/10.1038/srep00723">doi</a>.</li>
<li><a id="tacchella_economic_2013-2">[tacchella_economic_2013-2]</a> <a name="tacchella_economic_2013-2"></a>Tacchella, Cristelli, Caldarelli, Gabrielli & Pietronero, Economic Complexity: Conceptual Grounding of a New Metrics for Global Competitiveness, <i>Journal of Economic Dynamics and Control</i>, <b>37(8)</b>, 1683-1691 (2013). <a href="http://dx.doi.org/10.1016/j.jedc.2013.04.006">doi</a>.</li>
<li><a id="hidalgo_building_2009">[hidalgo_building_2009]</a> <a name="hidalgo_building_2009"></a>Hidalgo & Hausmann, The Building Blocks of Economic Complexity, <i>Proceedings of the National Academy of Sciences</i>, <b>106(26)</b>, 10570-10575 (2009). <a href="http://dx.doi.org/10.1073/pnas.0900943106">doi</a>.</li>
</ul>

</p>
</div>
</div>

<div id="outline-container-orgb27f3ee" class="outline-2">
<h2 id="orgb27f3ee"><span class="section-number-2">5</span> To-do</h2>
<div class="outline-text-2" id="text-5">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> Code RCA (fix divide by 0 problem)</li>
<li class="off"><code>[&#xa0;]</code> Lav rca by complexity measure (for each algortihm). Simple graph + linear function
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> Method of reflections</li>
<li class="off"><code>[&#xa0;]</code> Fitness2012</li>
<li class="off"><code>[&#xa0;]</code> Fitness2018</li>
</ul></li>
<li class="off"><code>[&#xa0;]</code> </li>

<li class="off"><code>[&#xa0;]</code> Set up trade unit values</li>
<li class="off"><code>[&#xa0;]</code> Set up REA</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Søren Post</p>
<p class="date">Created: 2020-02-21 Fri 14:27</p>
</div>
</body>
</html>
